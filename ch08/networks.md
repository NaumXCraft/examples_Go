### Что приходит с провода (физический уровень выдаёт канальному уровню)

Вот настоящий кусок реального Ethernet-фрейма в битах (hex для удобства):

```
55 55 55 55 55 55 55 D5    ← Преамбула (7 байт) + SFD (последний байт заканчивается на 101011)
00:1A:2B:3C:4D:5E          ← MAC-получатель (6 048 бит)
00:AA:BB:CC:DD:EE          ← MAC-отправитель (6 048 бит)
81 00 00 64                ← VLAN-тег (TPID=8100, VLAN ID=100)
08 00                      ← EtherType = IPv4
45 00 00 3C 12 34 40 00 ... ← Начало IP-пакета
... (ещё много байт IP-пакета)
... (в конце IP-пакета)
00 00 00 00 00 00 ...      ← Padding (если пакет был короткий)
1A 2B 3C 4D                ← FCS (CRC-32) — 4 байта
```

Теперь разберём по шагам простыми словами и покажем, что «отрезает» канальный уровень.

### Шаг за шагом — что делает приёмник

1. **Вижу преамбулу и старт**  
   Биты: `10101010 10101010 10101010 10101010 10101010 10101010 10101010 10101011`  
   → Понял: «Ага, сейчас начнётся кадр!»  
   → Отбрасываю эти 8 байт полностью.

2. **Читаю первые 48 бит — кому кадр?**  
   Биты: `00000000 00011010 00101011 00111100 01001101 01011110`  
   Это MAC = 00:1A:2B:3C:4D:5E  
   → Смотрю свой MAC. Допустим, у меня именно такой → «О, это мне!» → продолжаю.  
   Если бы не совпадало и не был бы FF:FF:FF:FF:FF:FF — выбросил бы сразу.

3. **Читаю следующие 48 бит — от кого**  
   `00000000 10101010 10111011 11001100 11011101 11101110` → 00:AA:BB:CC:DD:EE  
   Запоминаю: «Отправитель такой-то» (коммутатор запишет в таблицу).

4. **Вижу 81 00** → это VLAN-тег  
   `10000001 00000000 00000000 01100100` → VLAN ID = 100  
   Запоминаю, в какой VLAN пришёл кадр, потом отрежу эти 4 байта.

5. **Читаю EtherType**  
   `00001000 00000000` = 0x0800 → «Ага, внутри IPv4-пакет!»

6. **Принимаю всё до конца и считаю CRC**  
   Последние 32 бита: `00011010 00101011 00111100 01001101`  
   Сам пересчитываю CRC по всему кадру (кроме преамбулы и самого CRC).  
   Получилось то же самое → «Кадр целый, не битый!»

7. **Отрезаю всё лишнее**  
   Что отрезается навсегда:

    - 8 байт преамбулы
    - 6 байт свой MAC
    - 6 байт чужой MAC
    - 4 байта VLAN-тега
    - 4 байта CRC в конце
    - (если были нули в конце — это padding, тоже выкидываем)

   Осталось только это:

   ```
   08 00                   ← EtherType (но его тоже сейчас уберём)
   45 00 00 3C ...         ← чистый IP-пакет
   ```

8. **Смотрю EtherType 08 00** → знаю, что надо отдать в IPv4-обработчик  
   Отдаю вверх только начиная с 45 00… (то есть настоящий IP-пакет без всяких Ethernet-обвязок).

### Итог простыми словами

Представь, что кадр — это письмо в конверте:

- Конверт (Ethernet-заголовок + концевик):  
  «Кому: 00:1A:2B:3C:4D:5E, От кого: 00:AA:BB:CC:DD:EE, Тип письма: IPv4, VLAN 100, проверка печать 1A2B3C4D»

- Внутри конверта — чистое письмо (IP-пакет):  
  «Привет, я от 192.168.1.10, иду на 192.168.1.20, вот тебе данные…»

Канальный уровень — это секретарь, который:
1. Видит конверт на столе → открывает.
2. Проверяет, тебе ли адрес.
3. Проверяет, не порвана ли печать.
4. Выбрасывает конверт и все наклейки.
5. Отдаёт тебе только чистый листок (IP-пакет) со словами:  
   «Вот, это IPv4-пакет, разбирайся дальше сам».

Всё. Больше от Ethernet ничего не остаётся — сетевой уровень получает абсолютно чистый IP-пакет, как будто его по воздуху передали.
